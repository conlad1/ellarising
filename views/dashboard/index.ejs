<%- include('../partials/header', { title: 'Impact Dashboard', currentUser, currentPath: '/dashboard' }) %>

<section class="section">
  <div class="section-header">
    <h1 class="section-title">Impact Dashboard</h1>
    <p class="section-subtitle">
      Embedded Tableau dashboard showing satisfaction, STEAM graduation, and STEAM job rates by event type.
    </p>
  </div>

  <div class="card">
    <!-- Tableau Public Embed -->
    <div class="tableauPlaceholder" id="ellaRisesTableauDashboard" style="position: relative; width:100%;">
      <noscript>
        <a href="#">
          <img alt="Ella Rises Impact Dashboard"
               src="https://public.tableau.com/static/images/In/Intex_tableau_Sheet_1/Dashboard2/1_rss.png"
               style="border:none;" />
        </a>
      </noscript>

      <object class="tableauViz" style="display:none;">
        <param name="host_url" value="https%3A%2F%2Fpublic.tableau.com%2F" />
        <param name="embed_code_version" value="3" />
        <param name="site_root" value="" />
        <param name="name" value="Intex_tableau_Sheet_1/Dashboard2" />
        <param name="tabs" value="no" />
        <param name="toolbar" value="yes" />
        <param name="static_image"
               value="https://public.tableau.com/static/images/In/Intex_tableau_Sheet_1/Dashboard2/1.png" />
        <param name="animate_transition" value="yes" />
        <param name="display_static_image" value="yes" />
        <param name="display_spinner" value="yes" />
        <param name="display_overlay" value="yes" />
        <param name="display_count" value="yes" />
        <param name="language" value="en-US" />
        <param name="filter" value="publish=yes" />
      </object>
    </div>
  </div>
</section>

<script type="text/javascript">
  // Auto-resize the Tableau viz responsively
  const divElement = document.getElementById('ellaRisesTableauDashboard');
  const vizElement = divElement.getElementsByTagName('object')[0];

  function sizeTableauViz() {
    const width = divElement.offsetWidth;
    if (width > 800) {
      vizElement.style.width = '100%';
      vizElement.style.height = (width * 0.75) + 'px';
    } else if (width > 500) {
      vizElement.style.width = '100%';
      vizElement.style.height = (width * 0.75) + 'px';
    } else {
      vizElement.style.width = '100%';
      vizElement.style.height = '977px';
    }
  }

  sizeTableauViz();
  window.addEventListener('resize', sizeTableauViz);

  const scriptElement = document.createElement('script');
  scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';
  vizElement.parentNode.insertBefore(scriptElement, vizElement);
</script>

<%- include('../partials/footer') %>