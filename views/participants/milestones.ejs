<% if (!milestones || milestones.length === 0) { %>
  <p>No milestones recorded yet.</p>
<% } else { %>
  <ul class="milestone-list">
    <% milestones.forEach(m => { %>
      <li style="display: flex; justify-content: space-between; align-items: center;">
        <span>
          <strong><%= m.title %></strong>
          <% if (m.achieved_date_formatted) { %>
            <span class="muted"> – achieved on <%= m.achieved_date_formatted %></span>
          <% } else { %>
            <span class="muted"> – not yet achieved</span>
          <% } %>
        </span>
        <% if (currentUser && currentUser.role === 'admin') { %>
          <div style="display: flex; gap: 0.5rem;">
            <a href="/participants/<%= participant.id %>/milestones/<%= m.id %>/edit" class="btn btn-small btn-outline">Edit Date</a>
            <form action="/participants/<%= participant.id %>/milestones/<%= m.id %>/delete" method="POST" class="inline-form" style="display: inline-block;">
              <button class="btn btn-small btn-outline link-danger" onclick="return confirm('Remove this milestone from this participant?');">Delete</button>
            </form>
          </div>
        <% } %>
      </li>
    <% }) %>
  </ul>
<% } %>

<% if (currentUser && currentUser.role === 'admin') { %>
  <a href="/participants/<%= participant.id %>/milestones/assign" class="btn btn-small btn-primary">
    Assign Milestone
  </a>
<% } %>
